<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¡ Test Rapido - Portfolio</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #10b981 0%, #059669 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        
        .header { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); color: white; padding: 30px; border-radius: 20px; text-align: center; margin-bottom: 30px; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .card-header { font-size: 1.5rem; font-weight: 600; color: #374151; margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }
        
        .btn { display: inline-block; padding: 12px 24px; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.3s; margin-right: 12px; margin-bottom: 12px; text-decoration: none; color: white; }
        .btn-primary { background: #3b82f6; }
        .btn-success { background: #10b981; }
        .btn-danger { background: #ef4444; }
        .btn-warning { background: #f59e0b; }
        
        .status { padding: 16px; border-radius: 12px; margin: 16px 0; font-weight: 500; }
        .status-success { background: #dcfce7; color: #16a34a; border: 1px solid #bbf7d0; }
        .status-error { background: #fef2f2; color: #dc2626; border: 1px solid #fecaca; }
        .status-info { background: #dbeafe; color: #2563eb; border: 1px solid #bfdbfe; }
        
        .result-box { background: #f8fafc; border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px; margin: 16px 0; }
        pre { background: #1f2937; color: #e5e7eb; padding: 16px; border-radius: 8px; overflow-x: auto; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âš¡ Test Rapido Portfolio</h1>
            <p>Verifica veloce di Login, Email e Progetti</p>
        </div>

        <div class="grid">
            <!-- Test Login -->
            <div class="card">
                <div class="card-header">ğŸ” Test Login</div>
                <button onclick="testLogin()" class="btn btn-primary">ğŸ”“ Test Login Admin</button>
                <button onclick="testReactLogin()" class="btn btn-success">âš›ï¸ Test React API</button>
                <div id="login-result" class="result-box" style="display:none;"></div>
            </div>

            <!-- Test Email -->
            <div class="card">
                <div class="card-header">ğŸ“§ Test Email</div>
                <button onclick="testEmail()" class="btn btn-warning">ğŸ“§ Invia Email Test</button>
                <button onclick="testEmailHTML()" class="btn btn-success">ğŸ¨ Test Email HTML</button>
                <div id="email-result" class="result-box" style="display:none;"></div>
            </div>

            <!-- Test Progetti -->
            <div class="card">
                <div class="card-header">ğŸš€ Test Progetti</div>
                <button onclick="testCreateProject()" class="btn btn-success">â• Crea Progetto</button>
                <button onclick="testUploadImage()" class="btn btn-primary">ğŸ–¼ï¸ Test Upload</button>
                <div id="project-result" class="result-box" style="display:none;"></div>
            </div>
        </div>

        <!-- Console Risultati -->
        <div class="card" style="margin-top: 30px;">
            <div class="card-header">ğŸ–¥ï¸ Console Risultati</div>
            <button onclick="runAllTests()" class="btn btn-danger">ğŸš€ Esegui Tutti i Test</button>
            <button onclick="clearConsole()" class="btn btn-warning">ğŸ—‘ï¸ Pulisci</button>
            <pre id="console">Test rapido inizializzato
Timestamp: <?= date('Y-m-d H:i:s') ?>
========================</pre>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸';
            console.innerHTML += `\n[${timestamp}] ${prefix} ${message}`;
            console.scrollTop = console.scrollHeight;
        }

        function showResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result-box status-${type}`;
            element.innerHTML = message;
        }

        async function testLogin() {
            log('Testing admin login...');
            try {
                const response = await fetch('/debug.php?endpoint=login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'vincenzorocca88@gmail.com',
                        password: 'admin123'
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    showResult('login-result', `âœ… Login riuscito: ${result.user.name} (Admin: ${result.user.is_admin})`, 'success');
                    log(`Login successful: ${result.user.name}`, 'success');
                } else {
                    showResult('login-result', `âŒ Login fallito: ${result.message}`, 'error');
                    log(`Login failed: ${result.message}`, 'error');
                }
            } catch (error) {
                showResult('login-result', `âŒ Errore: ${error.message}`, 'error');
                log(`Login error: ${error.message}`, 'error');
            }
        }

        async function testReactLogin() {
            log('Testing React API login...');
            try {
                const response = await fetch('https://vincenzorocca.com/debug.php?endpoint=login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'vincenzorocca88@gmail.com',
                        password: 'admin123'
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    showResult('login-result', `âœ… React API Login OK: ${result.user.name}`, 'success');
                    log(`React API login successful: ${result.user.name}`, 'success');
                } else {
                    showResult('login-result', `âŒ React API Login fallito: ${result.message}`, 'error');
                    log(`React API login failed: ${result.message}`, 'error');
                }
            } catch (error) {
                showResult('login-result', `âŒ React API Errore: ${error.message}`, 'error');
                log(`React API error: ${error.message}`, 'error');
            }
        }

        async function testEmail() {
            log('Testing email sending...');
            try {
                const response = await fetch('/api-proxy.php/v1/contacts', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: 'Test Rapido',
                        email: 'test@example.com',
                        subject: 'Test Email Rapido',
                        message: 'Questo Ã¨ un test email rapido per verificare il sistema.\n\nTimestamp: ' + new Date().toLocaleString()
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    showResult('email-result', `âœ… Email inviata! ID: ${result.data.contact_id}, Email sent: ${result.data.email_sent}`, 'success');
                    log(`Email sent successfully: ID ${result.data.contact_id}`, 'success');
                } else {
                    showResult('email-result', `âŒ Email fallita: ${result.error}`, 'error');
                    log(`Email failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showResult('email-result', `âŒ Errore email: ${error.message}`, 'error');
                log(`Email error: ${error.message}`, 'error');
            }
        }

        async function testEmailHTML() {
            log('Testing HTML email...');
            try {
                const response = await fetch('/api-direct.php?endpoint=contacts', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: 'Test HTML Email',
                        email: 'test@example.com',
                        phone: '+39 123 456 7890',
                        company: 'Test Company',
                        subject: 'Test Email HTML Bellissima',
                        message: 'Questo Ã¨ un test per verificare che l\'email HTML sia bella e formattata correttamente.\n\nCon CSS, colori e layout responsive!',
                        budget: 'â‚¬5.000 - â‚¬10.000',
                        timeline: '2-3 mesi',
                        project_type: 'Sito Web'
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    showResult('email-result', `âœ… Email HTML inviata! ID: ${result.contact_id}, Email sent: ${result.email_sent}`, 'success');
                    log(`HTML Email sent successfully: ID ${result.contact_id}`, 'success');
                } else {
                    showResult('email-result', `âŒ Email HTML fallita: ${result.error}`, 'error');
                    log(`HTML Email failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showResult('email-result', `âŒ Errore email HTML: ${error.message}`, 'error');
                log(`HTML Email error: ${error.message}`, 'error');
            }
        }

        async function testCreateProject() {
            log('Testing project creation...');
            try {
                const response = await fetch('/api-direct.php?endpoint=projects', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        title: 'Progetto Test Rapido ' + Date.now(),
                        description: 'Progetto creato dal test rapido per verificare il sistema',
                        technologies: 'React, Laravel, MySQL, PHP',
                        category: 'web',
                        status: 'completed',
                        demo_url: 'https://vincenzorocca.com',
                        github_url: 'https://github.com/vincenzorocca'
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    showResult('project-result', `âœ… Progetto creato! ID: ${result.project_id}`, 'success');
                    log(`Project created successfully: ID ${result.project_id}`, 'success');
                } else {
                    showResult('project-result', `âŒ Creazione fallita: ${result.error || result.message}`, 'error');
                    log(`Project creation failed: ${result.error || result.message}`, 'error');
                }
            } catch (error) {
                showResult('project-result', `âŒ Errore creazione: ${error.message}`, 'error');
                log(`Project creation error: ${error.message}`, 'error');
            }
        }

        async function testUploadImage() {
            log('Testing image upload simulation...');
            try {
                const response = await fetch('/debug.php?endpoint=admin/upload/image', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer test-token-123'
                    }
                });

                const result = await response.json();
                
                if (result.success) {
                    showResult('project-result', `âœ… Upload simulato! URL: ${result.data.url}`, 'success');
                    log(`Image upload simulated: ${result.data.url}`, 'success');
                } else {
                    showResult('project-result', `âŒ Upload fallito: ${result.message}`, 'error');
                    log(`Image upload failed: ${result.message}`, 'error');
                }
            } catch (error) {
                showResult('project-result', `âŒ Errore upload: ${error.message}`, 'error');
                log(`Image upload error: ${error.message}`, 'error');
            }
        }

        async function runAllTests() {
            log('=== STARTING ALL TESTS ===');
            
            await testLogin();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testReactLogin();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testEmail();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testEmailHTML();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testCreateProject();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testUploadImage();
            
            log('=== ALL TESTS COMPLETED ===');
        }

        function clearConsole() {
            document.getElementById('console').innerHTML = 'Console pulita\nTimestamp: ' + new Date().toLocaleString();
        }

        // Initialize
        window.onload = function() {
            log('Test rapido initialized');
        };
    </script>
</body>
</html> 